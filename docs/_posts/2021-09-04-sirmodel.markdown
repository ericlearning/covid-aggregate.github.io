---
layout: post
title:  "SIR Model, and its variants for Epidemiological Modeling"
date:   2021-09-04 00:58:35 +0900
categories: Misc
mathjax: true
p5js: true
---

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/sylvester/0.1.3/sylvester.js"></script>
<script type="text/javascript" src="{{ "assets/p1/libraries/grafica.min.js" | relative_url }}"></script>
<script type="text/javascript" src="{{ "assets/p1/models/models.js" | relative_url }}"></script>
<script type="text/javascript" src="{{ "assets/p1/odesolver/rungekutta.js" | relative_url }}"></script>
<script type="text/javascript" src="{{ "assets/p1/odesolver/utils.js" | relative_url }}"></script>
<script type="text/javascript" src="{{ "assets/p1/visualization/utils.js" | relative_url }}"></script>


At an individual level, the spread of an epidemic appears quite random.

If I took a bus with those infected by COVID-19, I might have been infected. If I missed the bus that and chose to take a cab, I might have been safe. From the first-person perspective we have in our lives, the spread of an infectious disease often seems like a random event as the result of a coin-flip.<br/>

{% comment %}
{% include image.html url="https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/Coin_Toss_%283635981474%29.jpg/800px-Coin_Toss_%283635981474%29.jpg" caption="All at a coin toss." width="50%"%}
{% endcomment %}

But at a broader level, there is a different story. Looking at the COVID-19 statistics over time, **there is a clear sign of trend**:
* The rise of the cases at an exponential fashion
* waves that look similar to each other
* falls and rises that correspond to various government-level policies (quarantine, vaccination), etc.

The **stochastic events** at a local scale in complex systems (human civilization) leads to the [emergence](https://en.wikipedia.org/wiki/Emergence) of **new behaviors** only present at a global scale.

In this case, it would be possible to express the general trend of an epidemic over time $$t$$ using a mathematical model $$F(t)$$, which can be tweaked with various knobs $$\alpha, \beta$$ that brings the real data $$D$$ and the model's prediction closer $$D(t) \sim F(t, \alpha, \beta)$$.

Once such model is obtained, one should be able to predict the spread of the virus into the future by extrapolating $$t$$ into the future. Governments can tweak the knobs of the model and make predictions to be informed of the consequence certain [interventions](https://en.wikipedia.org/wiki/Public_health_intervention). With this information, they can decide what is the best course of action to contain the virus and bring down the cases to zero.

The search for such model of an infectious disease is largely discussed in the field of [epidemiology](https://www.cdc.gov/careerpaths/k12teacherroadmap/epidemiology.html).
> By definition, epidemiology is the study ... of the distribution ... and determinants ... of health-related states and events (not just diseases) in specified populations (neighborhood, school, city, state, country, global).
>
> &mdash; <cite>[Principles of Epidemiology in Public Health Practice, Third Edition](https://www.cdc.gov/csels/dsepd/ss1978/index.html)</cite>

Especially in the COVID-19 epidemic, [numerous researches](https://arxiv.org/pdf/2104.12556.pdf) experimented with the **shape (mathematical formalization)** and the **knob (parameter)** of the model to create a model that can give the best insights about this epidemic. These models have been used to make [important public health decisions](https://www.nature.com/articles/d41586-020-01003-6).

## Susceptible, Infectious, Recovered

One of the simplest, and reasonably effective model is the SIR Model. Given the current time $$t$$, the SIR Model predicts the number of susceptible $$S(t)$$, infectious $$I(t)$$, and recovered individuals $$R(t)$$.

As all mathematical models of reality are, the SIR model builds on [several assumptions](https://jamanetwork.com/journals/jama/fullarticle/2766672):


**Individuals go through $$S \to I \to R$$**
* $$I \to R$$ is a reasonable assumption in measeles, which lets those infected within [retain their immunity](https://www.bphc.org/whatwedo/infectious-diseases/Infectious-Diseases-A-to-Z/Pages/Measles.aspx); Hence remaining forever [^1] at $$R$$.
* $$S \to I$$ is not a reasonable assumption in many diseases. For example, the [viral load of a COVID-19 patient peaks few days before the symptom starts](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7929560/). It takes time to transition from $$S \to I$$.
* Staying on $$R$$ is not reasonable, as people sometimes get reinfected from the disease they recovered from.

[^1]: There are rare cases of measle reinfection, but we are talking in general here.

**Population remains constant: $$S(t) + I(t) + R(t) = N$$**
* This fails to account for events such as child birth and death.

**There is a homogeneous mixing of the population (everyone has equal chance of contact).**
* People form different subgroups that they interact more often than others.
* Individuals have difference in how frequently they interact with others.
* Population density is not homogeneous across areas.

## P5JS Plot Examples

<div id="sketch">
    <script type="text/javascript" src="{{ "assets/p1/sir_projection.js" | relative_url }}"></script>
</div><br/>

<div id="sketch2">
    <script type="text/javascript" src="{{ "assets/p1/sirs_projection.js" | relative_url }}"></script>
</div><br/>

<div id="sketch4">
    <script type="text/javascript" src="{{ "assets/p1/seir_projection.js" | relative_url }}"></script>
</div><br/>

<div id="sketch3">
    <script type="text/javascript" src="{{ "assets/p1/sirv_projection.js" | relative_url }}"></script>
</div><br/>

